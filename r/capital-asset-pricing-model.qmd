---
title: The Capital Asset Pricing Model
metadata:
  pagetitle: The CAPM with R
  description-meta: Learn how to use the programming language R for estimating the CAPM for asset evaluation.
---

The Capital Asset Pricing Model (CAPM) is one of the most influential theories in finance and builds on the foundation laid by [Modern Portfolio Theory](modern-portfolio-theory.qmd) (MPT). It was simultaneously developed by @Sharpe1964, @Lintner1965, and @Mossin1966. While MPT shows how to construct optimal portfolios, the CAPM extends this framework to explain how assets should be priced in equilibrium when all investors follow MPT principles. The CAPM is the simplest model that aims to explain equilibrium asset prices and hence the cornerstone for a myriad of extensions. It is also used in industry applications, in particular for performance evaluation, as it provides a simple measure of the market risk of an asset or portfolio. This chapter shows how to estimate the CAPM. We download stock market data, estimate betas using regression analysis, and evaluate asset performance.

We use the following packages throughout this chapter:


```{r}
#| message: false
#| warning: false
library(tidyverse)
library(tidyfinance)
library(scales)
library(ggrepel)
```

## Asset Returns & Volatilities

Building on our analysis from the previous chapter on [Modern Portfolio Theory](modern-portfolio-theory.qmd), we again examine the Dow Jones Industrial Average constituents. However, our focus shifts from portfolio optimization to understanding how these assets are priced in equilibrium. Let's start by downloading and preparing our daily return data:

```{r}
#| output: false
symbols <- download_data(
  type = "constituents",
  index = "Dow Jones Industrial Average"
)

prices_daily <- download_data(
    type = "stock_prices", symbol = symbols$symbol,
    start_date = "2019-10-01", end_date = "2024-09-30"
) |> 
  select(symbol, date,  price = adjusted_close)

returns_daily <- prices_daily |>
  group_by(symbol) |> 
  mutate(ret = price / lag(price) - 1) |>
  ungroup() |> 
  select(symbol, date, ret) |> 
  drop_na(ret) |> 
  arrange(symbol, date)
```

The relationship between risk and return is central to the CAPM. Figure @fig-300 plots average returns against volatilities for our sample of stocks, highlighting two particularly interesting cases: Boeing (BA) and Nvidia (NVDA). This visualization raises an important question: why don't we observe a clear positive relationship between risk and return?

```{r}
#| label: fig-300
#| fig-cap: "Average returns and volatilities are based on returns adjusted for dividend payments and stock splits." 
#| fig-alt: "Title: Average returns and volatilities of Dow index constituents. The figure shows a scatter plot with volatilities on the horizontal axis and average returns on the vertical axis. The stocks Nvidia and Boeing are highlighted because they exhibit the highest and lower average returns, respectively."
assets <- returns_daily |> 
  group_by(symbol) |> 
  summarize(mu = mean(ret), sigma = sd(ret))

fig_vola_return <- assets |> 
  ggplot(aes(x = sigma, y = mu)) +
  geom_point() + 
  geom_label_repel(data = assets |> filter(symbol %in% c("BA", "NVDA")),
                   aes(label = symbol)) +
  scale_x_continuous(labels = percent) +
  scale_y_continuous(labels = percent) + 
  labs(x = "Volatility", y = "Average return",
       title = "Average returns and volatilities of Dow index constituents") 
fig_vola_return
```

This apparent puzzle - that higher volatility doesn't necessarily lead to higher returns - motivates one of CAPM's key insights: not all risks are rewarded in equilibrium. To understand this, we need to distinguish between systematic and idiosyncratic risk.

Company-specific events might affect individual stock prices, e.g., CEO resignations, product launches, and earnings reports. These idiosyncratic events don't necessarily impact the overall market and this asset-specific risk can be eliminated through diversification. Therefore, we call this risk idiosyncratic. Systematic risk, on the other hand, affects all assets in the market at the same time and investors really dislike it because it cannot be diversified away. 

## Portfolio Return & Variance

While we covered portfolio mathematics in detail in the previous chapter, CAPM introduces a crucial new element: the risk-free asset. This addition fundamentally changes the investment opportunity set and leads to powerful conclusions about optimal portfolio choice.

To recap, we use the notion of expected portfolio return:

$$\text{Expected Portfolio Return} = \omega'\mu,$$

where $\omega$ is the vector of asset weights and $\mu$ is vector of expected return of assets. 

Portfolio variance is given by:

$$\text{Portfolio Variance} = \omega' \Sigma \omega$$
where $\Sigma$ is the variance-covariance matrix.

The introduction of a risk-free asset transforms the investment problem. Instead of choosing only between risky assets, investors can now combine a risky portfolio with risk-free lending or borrowing. Let  $r_f$ be the return of the risk-free asset (e.g., a short-term government bond), then we can describe the combined portfolio return as

$$\mu_c = c \omega'\mu + (1-c)r_f = r_f + c (\omega'\mu - r_f),$$
where $c$ is the fraction of capital in the risky portfolio. 

By assumption, the risk-free asset has zero volatility. The risk of the combined portfolio is thus only measured by the volatility of the risk assets:

$$\sigma_c= c\sqrt{\omega' \Sigma \omega} \Rightarrow c = \frac{\sigma_c}{\sqrt{\omega' \Sigma \omega}}$$

This equation allows us to derive a **Capital Allocation Line** (CAL): 

$$\mu_c = r_f +\sigma_c \frac{\omega'\mu-r_f}{\sqrt{\omega' \Sigma \omega}}$$

Importantly, the slope of CAL is called **Sharpe ratio**:

$$\text{Sharpe ratio} = \frac{\omega'\mu-r_f}{\sqrt{\omega' \Sigma \omega}}$$

The Sharpe ratio measures the *excess return per unit of risk*. A higher ratio hence indicates a more attractive *risk-adjusted return*. 

Let's illustrate the Sharpe ratios and CALs using a few example portfolios. To construct combined portfolios, we need a measure for the risk-free rate. One way to calculate risk-free rates is to use the 13-week T-bill rate (with the symbol ^IRX). Since the prices are quoted in annualized percentage yields, we have to divide them by 100 and convert them to daily rates using 252 trading days.^[Note that the resulting returns have a 99% correlation with Fama-French risk-free rate.] 

```{r}
risk_free_daily <- download_data(
  type = "stock_prices", symbol = "^IRX", 
  start_date = "2019-10-01", end_date = "2024-09-30"
) |> 
  mutate(
    risk_free = (1 + adjusted_close / 100)^(1 / 252) - 1
  ) |> 
  select(date, risk_free) |> 
  drop_na()
```

We also prepare the vector of expected returns and calculate the variance-covariance matrix. 

```{r}
mu <- assets$mu
sigma <- returns_daily |> 
  pivot_wider(names_from = symbol, values_from = ret)  |> 
  select(-date) |> 
  cov()
```

As a first example portfolio, we construct a portfolio of equal weights across the risky assets. 

```{r}
number_of_assets <- nrow(assets)
omega_ew <- rep(1 / number_of_assets, number_of_assets)

summary_ew <- tibble(
  mu = as.numeric(t(omega_ew) %*% mu),
  sigma = as.numeric(sqrt(t(omega_ew) %*% sigma %*% omega_ew)),
  type = "Equal-Weighted Portfolio"
)
```

As another example, we construct a portfolio using random weights in the risky assets. 

```{r}
set.seed(1234)
omega_random <- runif(number_of_assets, -1, 1)
omega_random <- omega_random / sum(omega_random)

summary_random <- tibble(
  mu = as.numeric(t(omega_random) %*% mu),
  sigma = as.numeric(sqrt(t(omega_random) %*% sigma %*% omega_random)),
  type = "Randomly-Weighted Portfolio"
)
```

The last portfolio is invested only in the risk-free asset. 

```{r}
summary_risk_free <- tibble(
  mu =  mean(risk_free_daily$risk_free),
  sigma = 0,
  type = "Risk-Free Asset"
)
```

By combining this risk-free portfolio with the other two risky portfolios, we can draw CALs. To facilitate the computation, we introduce a helper function that calculates the slope of the CALs - the Sharpe ratios. 

```{r}
calculate_sharpe_ratio <- function(mu, sigma, risk_free) {
  as.numeric(mu - risk_free) / sigma 
}

summaries <- bind_rows(assets, summary_ew, summary_random, summary_risk_free)

summaries <- summaries |> 
  mutate(
    sharpe_ratio = if_else(
      str_detect(type, "Portfolio"), 
      calculate_sharpe_ratio(mu, sigma, risk_free = summary_risk_free$mu),
      NA
    ),
    risk_free = summary_risk_free$mu
  )
```

@fig-301 now plots the CALs that connect the risk-free asset to the equal-weighted and randomly-weighted portfolio, respectively. We can see that the CALs look very similar although both portfolios have different risk-return profiles. 

```{r}
#| label: fig-301
#| fig-cap: "Points correspond to individual assets, crosses to portfolios." 
#| fig-alt: "Title: Average returns and volatilities of Dow index constituents with capital allocation lines. The figure shows a scatter plot with volatities on the horizontal axis and average returns on the vertical axis. In addition, the figure shows capital allocation lines that connect the risk-free asset to the equal-weighted and randomly-weighted portfolio, respectively."
#| warning: false
fig_cal <- summaries |> 
  ggplot(aes(x = sigma, y = mu)) +
  geom_abline(aes(intercept = risk_free, slope = sharpe_ratio, color = type),
              linetype = "dashed", linewidth = 1) +
  geom_point(data = summaries |> filter(is.na(type))) +
  geom_point(data = summaries |> filter(!is.na(type)), shape = 4, size = 4) + 
  geom_label_repel(aes(label = type)) + 
  scale_x_continuous(labels = percent) +
  scale_y_continuous(labels = percent) + 
  labs(
    x = "Volatility", y = "Average return",
    title = "Average returns and volatilities of Dow index constituents with capital allocation lines"
  ) +
  theme(legend.position = "none")
fig_cal
```

## The Tangency Portfolio

So far we have only chosen arbitrary portfolios. Now, we want to look for an optimal portfolio. In particular, we look for a portfolio that maximizes the Sharpe ratio;

$$\max_w \frac{\omega' \mu - r_f}{\sqrt{\omega' \Sigma \omega}},$$
while staying **fully invested**

$$ \omega'\iota = 1.$$

The resulting optimal portfolio is called the *tangency portfolio* (and you see in a minute why). We can calculate the tangency portfolio using the following **analytic solution** ^[See [this online resource](https://bookdown.org/compfinezbook/introcompfinr/Efficient-portfolios-of.html#computing-the-tangency-portfolio-using-matrix-algebra)) provided by @Zivot2026 for details on the derivation.]

$$\omega_{tan}=\frac{\Sigma^{-1}(\mu-r_f)}{\iota'\Sigma^{-1}(\mu-r_f)}$$
The next code chunk implements the analytic solution.

```{r}
omega_tangency <- solve(sigma) %*% (mu - summary_risk_free$mu)
omega_tangency <- as.vector(omega_tangency / sum(omega_tangency))

summary_tangency <- tibble(
  mu = as.numeric(t(omega_tangency) %*% mu),
  sigma = as.numeric(sqrt(t(omega_tangency) %*% sigma %*% omega_tangency)),
  type = "Tangency Portfolio",
  sharpe_ratio = calculate_sharpe_ratio(mu, sigma, risk_free = summary_risk_free$mu),
  risk_free = summary_risk_free$mu
)
```

## The Capital Market Line 

Now that we have the tangency portfolio, we want to derive the CAL by combining it with the risk-free asset. This combination is called the *Capital Market Line* (CML):

$$\mu_{c} = r_f +\sigma_c \frac{\omega_{tan}'\mu-r_f}{\sqrt{\omega_{tan}' \Sigma \omega_{tan}}}$$

The CML describes *best risk-return trade-off* for portfolios that contain the risk-free asset and the tangency portfolio. We can plot the CML by recycling the code from above:

```{r}
#| label: fig-302
#| fig-cap: "Points correspond to individual assets, crosses to portfolios." 
#| fig-alt: "Title: Average returns and volatilities of Dow index constituents with capital allocation lines. The figure shows a scatter plot with volatities on the horizontal axis and average returns on the vertical axis. In addition, the figure shows capital allocation lines that connect the risk-free asset to the equal-weighted, randomly-weighted, and tangency portfolio, respectively."
#| warning: false
summaries <- bind_rows(summaries, summary_tangency)

fig_cml <- summaries |> 
  ggplot(aes(x = sigma, y = mu)) +
  geom_abline(aes(intercept = risk_free, slope = sharpe_ratio, color = type),
              linetype = "dashed", linewidth = 1) +
  geom_point(data = summaries |> filter(is.na(type))) +
  geom_point(data = summaries |> filter(!is.na(type)), shape = 4, size = 4) + 
  ggrepel::geom_label_repel(aes(label = type)) + 
  scale_x_continuous(labels = percent) +
  scale_y_continuous(labels = percent) + 
  labs(x = "Volatility", y = "Average return",
       title = "Average returns and volatilities of Dow index constituents with the capital market line") +
  theme(legend.position = "none")
fig_cml
```

## Individual Assets and the Market Portfolio

While our previous analysis focused on portfolios, the CAPM's real power lies in explaining the pricing of individual assets. The model provides two key insights:

1. All rational investors prefer portfolios on the CML to individual assets or any other portfolios.
1. The tangency portfolio serves as the optimal risky portfolio for all investors.

This leads to a powerful conclusion: in equilibrium, all investors hold some combination of the risk-free asset and the tangency portfolio, regardless of their risk preferences. Their only choice is how much to allocate to each.

Let's examine how individual assets relate to this optimal portfolio. We can calculate each asset $i$'s expected excess return (return above the risk-free rate) and compare it to its relationship with the tangency portfolio:

$$\mu_i - r_f = \beta_i \cdot (\omega_{tan}'\mu - r_f),$$

where

$$\beta_i = \frac{\text{Cov}(r_i, \omega_{tan}r)}{\omega_{tan}' \Sigma \omega_{tan}}$$

is called the **asset beta**. The mathematics of CAPM thus shows that an asset's expected excess return must be proportional to its risk contribution to the tangency portfolio.

We can calculate these excess returns as follows:

```{r}
tangency_weights <- tibble(
  symbol = assets$symbol, 
  omega_tangency = omega_tangency
)

returns_tangency_daily <- returns_daily |> 
  left_join(tangency_weights, join_by(symbol)) |> 
  group_by(date) |> 
  summarize(mkt_ret = weighted.mean(ret, omega_tangency))

returns_excess_daily <- returns_daily |> 
  left_join(returns_tangency_daily, join_by(date)) |> 
  left_join(risk_free_daily, join_by(date)) |> 
  mutate(ret_excess = ret - risk_free,
         mkt_excess = mkt_ret - risk_free) |> 
  select(symbol, date, ret_excess, mkt_excess)
```

For beta estimation, we employ regression analysis through a custom function. The `estimate_beta()` function runs a regression without an intercept (note the -1 in the formula) to directly capture the relationship between asset excess returns and market excess returns. We leverage `tidyverse`'s nested dataframes to efficiently run these regressions for all assets simultaneously. The `map_dbl()` function applies our regression to each nested dataset and extracts the beta coefficient, giving us a clean data frame of assets and their corresponding betas.

```{r}
estimate_beta <- function(data) {
  fit <- lm("ret_excess ~ mkt_excess - 1", data = data)
  coefficients(fit)
}
  
beta_results <- returns_excess_daily |> 
  nest(data = -symbol) |> 
  mutate(beta = map_dbl(data, estimate_beta))
```

Figure @fig-303 presents these estimated betas. By ordering assets according to their beta values, we create a clear ranking of market sensitivity across our sample of stocks. This visualization makes it easy to identify which stocks are more defensive (beta < 1) versus aggressive (beta > 1) in their relationship with market movements.

```{r}
#| label: fig-303
#| fig-cap: "Weights are based on returns adjusted for dividend payments and stock splits." 
#| fig-alt: "Title: Estimated asset betas based on the tangency portfolio for Dow index constituents. The figure shows a bar chart with estimated asset betas for each Dow index constituent."
fig_betas <- beta_results |> 
  ggplot(aes(x = beta, y = fct_reorder(symbol, beta))) +
  geom_col() +
  labs(
    x = "Estimated asset beta", y = NULL, 
    title = "Estimated asset betas based on the tangency portfolio for Dow index constituents"
  )
fig_betas
```

Figure @fig-304 brings together theory and empirics by plotting the SML. We first calculate excess returns for the assets and combine this with our beta estimates. The plot includes a 45-degree line representing the theoretical CAPM relationship, where an asset's excess return should exactly equal its beta times the market excess return. By overlaying the actual data points and highlighting specific stocks (BA and NVDA), we can visually assess how well CAPM explains the cross-section of returns in our sample. This plot effectively demonstrates both the strengths and potential limitations of CAPM as an asset pricing model.

```{r}
#| label: fig-304
#| fig-cap: "Estimates are based on returns adjusted for dividend payments and stock splits and using the tangency portfolio as a measure for the market." 
#| fig-alt: "Title: Estimated CAPM-betas and average returns for Dow index constituents. The figure shows a bar scatter plot with estimated asset betas on the horizontal and average returns on the vertical axis. All points fall onto the 45-degree line."
assets <- assets |> 
  mutate(mu_excess = mu - summary_risk_free$mu) |> 
  left_join(beta_results, join_by(symbol))
  
fig_betas_returns <- assets |> 
  ggplot(aes(x = beta, y = mu_excess)) + 
  geom_abline(intercept = 0, 
              slope = summary_tangency$mu - summary_risk_free$mu) + 
  geom_point() +
  geom_label_repel(data = assets |> filter(symbol %in% c("BA", "NVDA")),
                   aes(label = symbol)) + 
  scale_y_continuous(labels = percent) + 
  labs(
    x = "Estimated asset beta", y = "Average return", 
    title = "Estimated CAPM-betas and average returns for Dow index constituents"
  )
fig_betas_returns
```

## CAPM in Practice

While our previous analysis used the tangency portfolio to derive CAPM's key insights, implementing this approach in practice presents several challenges. Computing the tangency portfolio requires estimating expected returns and the variance-covariance matrix for potentially thousands of assets. This raises difficult questions: Which assets should we include in our universe? How can we reliably estimate these parameters, especially when the number of assets is large?

Fortunately, the CAPM provides an elegant solution. The model implies that in equilibrium, the market portfolio must equal the tangency portfolio. This theoretical insight leads to a practical simplification: instead of calculating complex tangency portfolio weights, we can use market capitalization-weighted portfolios as our benchmark. This approach aligns with the theoretical framework while being much simpler to implement.

It's worth noting that this simplification relies on several key assumptions underlying the CAPM:

- The model describes equilibrium in a single-period economy.
- Markets are frictionless, with no transaction costs or taxes.
- All investors can borrow and lend at the risk-free rate.
- Investors share the same expectations about returns and risks.
- Investors are rational, seeking to maximize returns for a given level of risk.

Despite these stringent assumptions (or rather because of them), the CAPM has become a cornerstone of modern finance. Its simplicity makes it an excellent foundation for more sophisticated models and a useful starting point for practical applications.

The model's practical implementation centers on SML. An asset's expected return is given by:

$$\mu_i =  r_f + \beta_i \cdot (\mu_m - r_f),$$

where beta measures the asset's systematic risk:

$$\beta_i = \frac{\sigma_{im}}{\sigma_m^2}.$$

Here, $\mu_m$ represents the expected market return, $\sigma_{im}$ is the covariance between the asset and market returns, and $\sigma_m^2$ is the market variance. This formulation is particularly useful for performance evaluation.

To assess an asset's performance, we introduce alpha ($\alpha_i$), which measures the difference between actual and expected returns:

$$\mu_i - r_f = \alpha_i + \beta_i \cdot (\mu_m - r_f)$$

Alpha provides a risk-adjusted performance measure. A positive alpha indicates that the asset outperformed its risk-adjusted benchmark, while a negative alpha suggests underperformance. This makes alpha a valuable tool for investment managers and analysts.

In practice, we estimate both alpha and beta using regression analysis. The empirical model is:

$$r_{i,t}  - r_{f,t}  = \hat{\alpha}_i + \hat{\beta}_i \cdot (r_{m,t} - r_{f,t} ) + \varepsilon_{i,t}, $$
where $r_{i,t}$ and $r_{m,t}$ are the realized returns of the asset and market portfolio on day $t$, respectively. The error term $\varepsilon_{i,t}$ captures the asset's idiosyncratic risk – the portion of returns unexplained by market movements.

Let's turn to estimating CAPM parameters using real market data. Instead of using our previously constructed tangency portfolio, we employ the Fama-French market returns, which provide a widely accepted proxy for the market portfolio. These returns are already adjusted to represent excess returns over the risk-free rate, simplifying our analysis.

```{r}
factors <- download_data(
  type = "factors_ff_5_2x3_daily", 
  start_date = "2019-10-01", end_date = "2024-09-30"
) |> 
  select(date, mkt_excess, risk_free)
```

For our regression analysis, we first prepare the data by calculating excess returns for each stock. We join our daily returns with the Fama-French factors and subtract the risk-free rate to obtain excess returns. The `estimate_capm()` function then implements the regression equation we previously discussed:

```{r}
returns_excess_daily <- returns_daily |> 
  left_join(factors, join_by(date)) |> 
  mutate(ret_excess = ret - risk_free) |> 
  select(symbol, date, ret_excess, mkt_excess)

estimate_capm <- function(data) {
  fit <- lm("ret_excess ~ mkt_excess", data = data)
  tibble(
    coefficient = c("alpha", "beta"),
    estimate = coefficients(fit),
    t_statistic = summary(fit)$coefficients[, "t value"]
  )
}
  
capm_results <- returns_excess_daily |> 
  nest(data = -symbol) |> 
  mutate(capm = map(data, estimate_capm)) |> 
  unnest(capm) |> 
  select(symbol, coefficient, estimate, t_statistic)
```

The results are particularly interesting when we visualize the alphas across our sample of Dow Jones constituents. @fig-305 reveals the cross-sectional distribution of risk-adjusted performance, with positive values indicating outperformance and negative values indicating underperformance relative to what CAPM would predict. Statistical significance is indicated through color coding, showing which alphas are reliably different from zero at the 95% confidence level.

```{r}
#| label: fig-305
#| fig-cap: "Estimates are based on returns adjusted for dividend payments and stock splits and using the Fama-French market excess returns as a measure for the market." 
#| fig-alt: "Title: Estimated CAPM alphas for Dow index constituents. The figure shows a bar chart with estimated alphas and indicates whether an estimate is statistically significant at 95%. Only Nvidia exhibits a statistically significant positive alpha."
fig_alpha <- capm_results |> 
  filter(coefficient == "alpha") |> 
  mutate(is_significant = abs(t_statistic) >= 1.96) |> 
  ggplot(aes(x = estimate, y = fct_reorder(symbol, estimate), 
             fill = is_significant)) +
  geom_col() +
  scale_x_continuous(labels = percent) + 
  labs(
    x = "Estimated asset alphas", y = NULL, fill = "Significant at 95%?",
    title = "Estimated CAPM alphas for Dow index constituents"
  )
fig_alpha
```

Most notably, our analysis shows that only NVIDIA (NVDA) exhibits a statistically significant positive alpha during our sample period. This finding aligns with the exceptional performance of technology stocks, particularly those involved in AI and chip manufacturing, but suggests that most Dow components' returns can be explained by their market exposure alone.

## Shortcomings & Extensions

While the CAPM's elegance and simplicity have made it a cornerstone of modern finance, the model faces several important challenges in practice. Understanding these limitations is crucial for both academic research and practical applications.

A fundamental challenge lies in the identification of the market portfolio. The CAPM theory requires a truly universal market portfolio that includes all investable assets – not just stocks, but also real estate, private businesses, human capital, and even intangible assets. In practice, we must rely on proxies like the S&P 500, DAX, or TOPIX. The choice of market proxy can significantly impact our estimates and may need to be tailored to specific contexts. For instance, a U.S.-focused investor might use the S&P 500, while a Japanese investor might prefer the TOPIX.

Another crucial limitation concerns the stability of beta over time. The model assumes that an asset's systematic risk remains constant, but this rarely holds in practice. Companies undergo significant changes that can affect their market sensitivity: they may alter their capital structure, enter new markets, face new competitors, or transform their business models. Consider how tech companies' betas might change as they mature from growth startups to established enterprises, or how a retailer's beta might shift as it expands its online presence.

Perhaps most importantly, empirical evidence suggests that systematic risk alone cannot fully explain asset returns. Numerous studies have documented patterns in stock returns that CAPM cannot explain. Small-cap stocks tend to outperform large-cap stocks, and value stocks (those with high book-to-market ratios) tend to outperform growth stocks, even after adjusting for market risk. These "anomalies" suggest that investors may care about multiple dimensions of risk beyond market sensitivity.

These limitations have spawned a rich literature of alternative and extended models. The Fama-French three-factor model represents a seminal extension, adding two factors to capture the size and value effects:

- The SMB (Small Minus Big) factor captures the tendency of small stocks to outperform large stocks, as we discuss in our chapter [Size Sorts and P-Hacking](size-sorts-and-p-hacking.qmd).
- The HML (High Minus Low) factor captures the tendency of value stocks to outperform growth stocks, as we show in [Value and Bivariate Sorts](value-and-bivariate-sorts.qmd).
  
Building on this framework, the Fama-French five-factor model adds two more dimensions, which we later discuss in [Replicating Fama-French Factors](replicating-fama-and-french-factors.qmd):

- The RMW (Robust Minus Weak) factor captures the outperformance of companies with strong operating profitability
- The CMA (Conservative Minus Aggressive) factor reflects the tendency of companies with conservative investment policies to outperform those with aggressive investment policies

The field continues to evolve with various theoretical and empirical innovations. The Consumption CAPM links asset prices to macroeconomic risks through aggregate consumption. The Conditional CAPM allows risk premiums and betas to vary with the business cycle. The Carhart four-factor model adds momentum to the three-factor framework, while the Q-factor model and investment CAPM provide alternative theoretical foundations rooted in corporate finance.

Despite its limitations, the CAPM remains valuable as a conceptual framework and practical tool. Its core insight – that only systematic risk should be priced in equilibrium – continues to influence how we think about risk and return. Understanding both its strengths and weaknesses helps us apply it more effectively and appreciate the contributions of newer models that build upon its foundation.

## Key Takeaways

The CAPM provides a fundamental framework for understanding asset pricing and risk-return relationships. The key insights from this chapter are:

- The CAPM is an equilibrium model that assumes a frictionless economy where investors can freely trade without costs and borrow or lend at the risk-free rate
- In equilibrium, all investors hold some combination of the market portfolio and the risk-free asset, with their risk preferences determining only the proportion of each of the two.
- Expected returns follow a linear relationship with systematic risk: Assets with higher market sensitivity (beta) should earn higher returns to compensate investors for bearing undiversifiable risk.
- Beta measures an asset's sensitivity to market movements and can be estimated through linear regression of asset excess returns on market excess returns.
- While the model has limitations, its insights about systematic versus idiosyncratic risk continue to influence both academic research and practical investment decisions.

## Exercises

1. Download daily returns for a German stock of your choice and the S&P 500 index for the past five years. Calculate the stock's beta and interpret its meaning. How does your estimate change if you use monthly instead of daily returns?
1. Compare the betas of stocks estimated using different market proxies (e.g., S&P 500, Russell 3000, MSCI World). How do the differences in market definition affect your conclusions about systematic risk?
1. Select a mutual fund and estimate its alpha and beta relative to its benchmark index. Is the fund's performance statistically significant after accounting for market risk? How do your conclusions change if you use a different benchmark?
1. Compare betas of multinational companies using both local and global market indices. How do the estimates differ? What might explain these differences?