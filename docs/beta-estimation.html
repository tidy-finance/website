<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Beta Estimation | Tidy Finance</title>
<meta name="author" content="Christoph Scheuch, Patrick Weiss and Stefan Voigt">
<meta name="description" content="In this section, we introduce you to an important concept in financial economics: the exposure of an individual stock to changes in the market portfolio. According to the Capital Asset Pricing...">
<meta name="generator" content="bookdown 0.24.4 with bs4_book()">
<meta property="og:title" content="Chapter 4 Beta Estimation | Tidy Finance">
<meta property="og:type" content="book">
<meta property="og:description" content="In this section, we introduce you to an important concept in financial economics: the exposure of an individual stock to changes in the market portfolio. According to the Capital Asset Pricing...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Beta Estimation | Tidy Finance">
<meta name="twitter:description" content="In this section, we introduce you to an important concept in financial economics: the exposure of an individual stock to changes in the market portfolio. According to the Capital Asset Pricing...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tidy Finance</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li><a class="" href="introduction-to-tidy-finance.html"><span class="header-section-number">2</span> Introduction to Tidy Finance</a></li>
<li><a class="" href="accessing-managing-financial-data.html"><span class="header-section-number">3</span> Accessing &amp; Managing Financial Data</a></li>
<li><a class="active" href="beta-estimation.html"><span class="header-section-number">4</span> Beta Estimation</a></li>
<li><a class="" href="univariate-sorts.html"><span class="header-section-number">5</span> Univariate Sorts</a></li>
<li><a class="" href="univariate-sorts-firm-size.html"><span class="header-section-number">6</span> Univariate Sorts: Firm Size</a></li>
<li><a class="" href="bivariate-sorts-value.html"><span class="header-section-number">7</span> Bivariate Sorts: Value</a></li>
<li><a class="" href="bivariate-sorts-replication-of-fama-french-factors.html"><span class="header-section-number">8</span> Bivariate Sorts: Replication of Fama &amp; French Factors</a></li>
<li><a class="" href="factor-selection-via-machine-learning.html"><span class="header-section-number">9</span> Factor selection via machine learning</a></li>
<li><a class="" href="option-pricing-via-machine-learning-methods.html"><span class="header-section-number">10</span> Option Pricing via Machine learning methods</a></li>
<li><a class="" href="parametric-portfolio-policies.html"><span class="header-section-number">11</span> Parametric Portfolio Policies</a></li>
<li><a class="" href="constraint-optimization-and-portfolio-backtesting.html"><span class="header-section-number">12</span> Constraint Optimization and Portfolio Backtesting</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="beta-estimation" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Beta Estimation<a class="anchor" aria-label="anchor" href="#beta-estimation"><i class="fas fa-link"></i></a>
</h1>
<p>In this section, we introduce you to an important concept in financial economics: the exposure of an individual stock to changes in the market portfolio. According to the Capital Asset Pricing Model (CAPM), cross-sectional variation in expected asset returns should be a function of the covariance between the return of the asset and the return on the market portfolio – the beta. This section proposes an estimation procedure for these so-called market betas. We do not go into details about the foundations of market beta, but simply refer to any treatment of the <a href="https://en.wikipedia.org/wiki/Capital_asset_pricing_model">CAPM</a> for further information. More importantly, we provide details about all the functions that we use to compute the results.</p>
<p>We use the following packages throughout this section:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rsqlite.r-dbi.org">RSQLite</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/slider">slider</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/furrr">furrr</a></span><span class="op">)</span></code></pre></div>
<div id="estimate-beta-using-monthly-returns" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Estimate beta using monthly returns<a class="anchor" aria-label="anchor" href="#estimate-beta-using-monthly-returns"><i class="fas fa-link"></i></a>
</h2>
<p>The estimation procedure is based on a rolling window estimation where we may use either monthly or daily returns and different window lengths. First, let us start with the monthly data we prepared in an earlier chapter.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_finance</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data/tidy_finance.sqlite"</span>, extended_types <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">crsp_monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">tidy_finance</span>, <span class="st">"crsp_monthly"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">factors_ff_monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">tidy_finance</span>, <span class="st">"factors_ff_monthly"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">crsp_monthly</span> <span class="op">&lt;-</span> <span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">factors_ff_monthly</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, <span class="va">industry</span>, <span class="va">ret_excess</span>, <span class="va">mkt_excess</span><span class="op">)</span>

<span class="va">crsp_monthly</span></code></pre></div>
<pre><code>## # A tibble: 3,225,253 x 5
##    permno month      industry      ret_excess mkt_excess
##     &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;
##  1  10028 1995-03-01 Wholesale        0.0621      0.0219
##  2  10000 1986-02-01 Manufacturing   -0.262       0.0713
##  3  10043 1989-06-01 Services        -0.0071     -0.0135
##  4  10043 1989-07-01 Services         0.0269      0.072 
##  5  10043 1989-08-01 Services        -0.0238      0.0144
##  6  10043 1989-09-01 Services        -0.0648     -0.0076
##  7  10043 1989-10-01 Services         0.00205    -0.0367
##  8  10043 1989-11-01 Services        -0.130       0.0103
##  9  10028 1995-04-01 Wholesale       -0.192       0.0211
## 10  10028 1995-05-01 Wholesale        0.148       0.029 
## # ... with 3,225,243 more rows</code></pre>
<p>To estimate the CAPM equation
<span class="math display">\[
r_{i, t} - r_{f, t} = \alpha_i + \beta_i(r_{m, t}-r_{f,t})+\varepsilon_{i, t}
\]</span>
we have to regress excess stock returns <code>ret_excess</code> on excess returns of the market portfolio <code>mkt_excess</code>.
<code>R</code> provides a simple solution to estimate (linear) models with the function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> requires a formula as input which is specific in a compact symbolic form. An expression of the form <code>y ~ model</code> is interpreted as a specification that the response <code>y</code> is modeled by a linear predictor specified symbolically by <code>model</code>. Such a model consists of a series of terms separated by <code>+</code> operators. In addition to standard linear models, <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> provides a lot of flexibility. You should check out the documentation for more information. To start, we restrict the data only to the time series of observations in CRSP that correspond to Apple’s stock (<code>permno</code> of Apple is 14593) and compute <span class="math inline">\(\alpha_i\)</span> as well as <span class="math inline">\(\beta_i\)</span>.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ret_excess</span> <span class="op">~</span> <span class="va">mkt_excess</span>,
  data <span class="op">=</span> <span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">permno</span> <span class="op">==</span> <span class="st">"14593"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ret_excess ~ mkt_excess, data = crsp_monthly %&gt;% 
##     filter(permno == "14593"))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.51670 -0.06098  0.00090  0.06426  0.39402 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.010511   0.005316   1.977   0.0486 *  
## mkt_excess  1.400852   0.117479  11.924   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.1151 on 478 degrees of freedom
## Multiple R-squared:  0.2293, Adjusted R-squared:  0.2277 
## F-statistic: 142.2 on 1 and 478 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> returns an object of class <code>lm</code> which contains all information we usually care about with linear models. <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> returns an easy to understand overview of the estimated parameters. <code>coefficients(fit)</code> would return only the estimated coefficients. The output above indicates that Apple moves excessively with the market as the estimated <span class="math inline">\(\beta_i\)</span> is above one (<span class="math inline">\(\hat\beta_i\)</span> = 1.4).</p>
<p>Next, we scale the estimation of <span class="math inline">\(\beta_i\)</span> to a whole different level and perform rolling window estimations for the entire CRSP sample. The following function implements the regression for any data frame that contains at least <code>min_obs</code> observations to avoid huge fluctuations in case the time-series is just too short. If the condition is violated, the function returns a missing value.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">estimate_capm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">min_obs</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">min_obs</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ret_excess</span> <span class="op">~</span> <span class="va">mkt_excess</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
    <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Next, we define a function that does the rolling estimation. To perform the rolling window estimation, we use the <code>slider</code> package of <a href="https://github.com/DavisVaughan/slider">Davis Vaughan</a>, which provides a family of sliding window functions similar to <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code> which we already have seen in previous sections. Most importantly, the <code>slide_period</code> function is able to handle months in its window input in a straight-forward manner. We thus avoid using any time-series package (e.g., <code>zoo</code>) and converting the data to fit the package functions, but rather stay in the tidyverse.</p>
<p>The following function takes an input data and slides across the month vector, considering only at total of <code>months</code> months. As we demonstrate further below, we can apply the same function to daily returns data.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">roll_capm_estimation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">months</span>, <span class="va">min_obs</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Combine all rows into a single data frame (useful for daily data)</span>
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span>

  <span class="co"># Compute betas by sliding across months</span>
  <span class="va">betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slider/man/slide_period.html">slide_period_vec</a></span><span class="op">(</span>
    .x <span class="op">=</span> <span class="va">data</span>,
    .i <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">month</span>,
    .period <span class="op">=</span> <span class="st">"month"</span>,
    .f <span class="op">=</span> <span class="op">~</span> <span class="fu">estimate_capm</span><span class="op">(</span><span class="va">.</span>, <span class="va">min_obs</span><span class="op">)</span>,
    .before <span class="op">=</span> <span class="va">months</span> <span class="op">-</span> <span class="fl">1</span>,
    .complete <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>

  <span class="co"># Return a tibble with months and beta estimates (useful for daily data)</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">month</span><span class="op">)</span>,
    beta <span class="op">=</span> <span class="va">betas</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Before we attack the whole CRSP sample, let us focus on a couple of well known examples.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">permno</span>, <span class="op">~</span><span class="va">company</span>,
  <span class="fl">14593</span>, <span class="st">"Apple"</span>,
  <span class="fl">10107</span>, <span class="st">"Microsoft"</span>,
  <span class="fl">93436</span>, <span class="st">"Tesla"</span>,
  <span class="fl">17778</span>, <span class="st">"Berkshire Hathaway"</span>
<span class="op">)</span></code></pre></div>
<p>If we want to estimate the rolling betas for Apple, we can simple use <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_example</span> <span class="op">&lt;-</span> <span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">permno</span> <span class="op">==</span> <span class="va">examples</span><span class="op">$</span><span class="va">permno</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu">roll_capm_estimation</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">cur_data</a></span><span class="op">(</span><span class="op">)</span>, months <span class="op">=</span> <span class="fl">60</span>, min_obs <span class="op">=</span> <span class="fl">48</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">beta_example</span></code></pre></div>
<pre><code>## # A tibble: 433 x 6
##    permno month      industry      ret_excess mkt_excess  beta
##     &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
##  1  14593 1984-12-01 Manufacturing     0.170      0.0184  2.05
##  2  14593 1985-01-01 Manufacturing    -0.0108     0.0799  1.90
##  3  14593 1985-02-01 Manufacturing    -0.152      0.0122  1.88
##  4  14593 1985-03-01 Manufacturing    -0.112     -0.0084  1.89
##  5  14593 1985-04-01 Manufacturing    -0.0467    -0.0096  1.90
##  6  14593 1985-05-01 Manufacturing    -0.189      0.0509  1.76
##  7  14593 1985-06-01 Manufacturing     0.0305     0.0127  1.76
##  8  14593 1985-07-01 Manufacturing    -0.124     -0.0074  1.77
##  9  14593 1985-08-01 Manufacturing    -0.0606    -0.0102  1.78
## 10  14593 1985-09-01 Manufacturing     0.0440    -0.0454  1.71
## # ... with 423 more rows</code></pre>
<p>It is actually quite simple to perform the rolling window estimation for an arbitrary number fo stocks which we visualize in the following code chunk.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_examples</span> <span class="op">&lt;-</span> <span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">examples</span>, by <span class="op">=</span> <span class="st">"permno"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">permno</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu">roll_capm_estimation</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">cur_data</a></span><span class="op">(</span><span class="op">)</span>, months <span class="op">=</span> <span class="fl">60</span>, min_obs <span class="op">=</span> <span class="fl">48</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">company</span>, <span class="va">month</span>, beta_monthly <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">beta_examples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">beta_monthly</span>, color <span class="op">=</span> <span class="va">company</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, color <span class="op">=</span> <span class="cn">NULL</span>,
    title <span class="op">=</span> <span class="st">"Monthly beta estimates for example stocks using 5 years of monthly data"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="31_beta_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;">
Even though we could now just apply the function using <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> on the whole CRSP sample, we advise against doing it as it is computationally quite expensive. Remember that we have to perform rolling window estimations across all stocks and time periods. However, this estimation problem is an ideal scenario to employ the power of parallelization. Parallelization means that we split the tasks which perform rolling window estimations across different workers (or cores on your local machine). It turns out to be quite easy to implement with only a small addition to what we already have learned using <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> functions.</p>
<p>First, we nest the data by <code>permno</code>. Nested data means that we now have a list of <code>permno</code>s with corresponding time series data.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_monthly_nested</span> <span class="op">&lt;-</span> <span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">ret_excess</span>, <span class="va">mkt_excess</span><span class="op">)</span><span class="op">)</span>
<span class="va">crsp_monthly_nested</span></code></pre></div>
<pre><code>## # A tibble: 29,223 x 3
##    permno industry      data              
##     &lt;dbl&gt; &lt;chr&gt;         &lt;list&gt;            
##  1  10028 Wholesale     &lt;tibble [226 x 3]&gt;
##  2  10000 Manufacturing &lt;tibble [16 x 3]&gt; 
##  3  10043 Services      &lt;tibble [159 x 3]&gt;
##  4  10001 Utilities     &lt;tibble [378 x 3]&gt;
##  5  10028 Retail        &lt;tibble [112 x 3]&gt;
##  6  10044 Manufacturing &lt;tibble [418 x 3]&gt;
##  7  10002 Finance       &lt;tibble [324 x 3]&gt;
##  8  10029 Services      &lt;tibble [53 x 3]&gt; 
##  9  10045 Retail        &lt;tibble [13 x 3]&gt; 
## 10  10046 Services      &lt;tibble [108 x 3]&gt;
## # ... with 29,213 more rows</code></pre>
<p>First note that we could simply use <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> across all the <code>permno</code>s and get the same results as above.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_monthly_nested</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">examples</span>, by <span class="op">=</span> <span class="st">"permno"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu">roll_capm_estimation</span><span class="op">(</span><span class="va">.</span>, months <span class="op">=</span> <span class="fl">60</span>, min_obs <span class="op">=</span> <span class="fl">48</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, beta_monthly <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,362 x 3
##    permno month      beta_monthly
##     &lt;dbl&gt; &lt;date&gt;            &lt;dbl&gt;
##  1  10107 1990-03-01         1.39
##  2  10107 1990-04-01         1.38
##  3  10107 1990-05-01         1.43
##  4  10107 1990-06-01         1.43
##  5  10107 1990-07-01         1.45
##  6  10107 1990-08-01         1.44
##  7  10107 1990-09-01         1.41
##  8  10107 1990-10-01         1.42
##  9  10107 1990-11-01         1.41
## 10  10107 1990-12-01         1.41
## # ... with 1,352 more rows</code></pre>
<p>But instead we want to perform the estimations of rolling betas for different stocks in parallel. We can use the flexibility of the <code>future</code> package which we use to define how we want to perform the parallel estimation. If you have a Windows machine, it makes most sense to define <code>multisession</code> which means that separate <code>R</code> processes are running in the background on the same machine to perform the estimations. If you check out the documentation of <code><a href="https://future.futureverse.org/reference/plan.html">plan()</a></code>, you can see that there are other ways to resolve the parallelization.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/re-exports.html">availableCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Using 8 cores, the estimation for our sample of around 25k stocks takes around 20 mins. Of course you can speed up things considerably by having more cores available to share the workload. Note the difference in the code below? All you need to do is to replace <code>map</code> with <code>future_map</code>.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_monthly</span> <span class="op">&lt;-</span> <span class="va">crsp_monthly_nested</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/furrr/man/future_map.html">future_map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu">roll_capm_estimation</span><span class="op">(</span><span class="va">.</span>, months <span class="op">=</span> <span class="fl">60</span>, min_obs <span class="op">=</span> <span class="fl">48</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, beta_monthly <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">beta_monthly</span></code></pre></div>
<pre><code>## # A tibble: 2,070,653 x 3
##    permno month      beta_monthly
##     &lt;dbl&gt; &lt;date&gt;            &lt;dbl&gt;
##  1  10028 1996-02-01     -0.889  
##  2  10028 1996-03-01     -0.885  
##  3  10028 1996-04-01     -0.883  
##  4  10028 1996-05-01     -0.672  
##  5  10028 1996-06-01     -0.478  
##  6  10028 1996-07-01     -0.204  
##  7  10028 1996-08-01     -0.311  
##  8  10028 1996-09-01     -0.190  
##  9  10028 1996-10-01     -0.191  
## 10  10028 1996-11-01      0.00710
## # ... with 2,070,643 more rows</code></pre>
<p>Before we look at some descriptive statistics of our beta estimates, we implement the estimation for daily data as well. Depending on the application, you might either use longer horizon beta estimates based on monthly data or shorter horizon estimates based on daily returns.</p>
</div>
<div id="estimating-beta-using-daily-returns" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Estimating beta using daily returns<a class="anchor" aria-label="anchor" href="#estimating-beta-using-daily-returns"><i class="fas fa-link"></i></a>
</h2>
<p>First let us load daily CRSP data. Note that the sample is quite huge compared to the monthly data, so make sure to have enough memory available</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">tidy_finance</span>, <span class="st">"crsp_daily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>We also need daily Fama-French market excess returns.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">factors_ff_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">tidy_finance</span>, <span class="st">"factors_ff_daily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>We make sure to keep only relevant data.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_daily</span> <span class="op">&lt;-</span> <span class="va">crsp_daily</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">factors_ff_daily</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, <span class="va">ret_excess</span>, <span class="va">mkt_excess</span><span class="op">)</span>
<span class="va">crsp_daily</span></code></pre></div>
<pre><code>## # A tibble: 68,895,667 x 4
##    permno month      ret_excess mkt_excess
##     &lt;dbl&gt; &lt;date&gt;          &lt;dbl&gt;      &lt;dbl&gt;
##  1  10000 1986-01-01   -0.0246     -0.0216
##  2  10000 1986-01-01   -0.00025    -0.0117
##  3  10000 1986-01-01   -0.00025    -0.0002
##  4  10000 1986-01-01    0.0498      0.0028
##  5  10000 1986-01-01    0.0474      0.0001
##  6  10000 1986-01-01    0.0452      0.0079
##  7  10000 1986-01-01    0.0432      0.0046
##  8  10000 1986-01-01   -0.00025    -0.0017
##  9  10000 1986-01-01   -0.00025    -0.0039
## 10  10000 1986-01-01   -0.00025    -0.0067
## # ... with 68,895,657 more rows</code></pre>
<p>Just like above, we nest the data by <code>permno</code> for easy parallelization.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_daily_nested</span> <span class="op">&lt;-</span> <span class="va">crsp_daily</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">ret_excess</span>, <span class="va">mkt_excess</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This is what the estimation looks like for a couple of examples using <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code>.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_daily_nested</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">examples</span>, by <span class="op">=</span> <span class="st">"permno"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>beta_daily <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu">roll_capm_estimation</span><span class="op">(</span><span class="va">.</span>, months <span class="op">=</span> <span class="fl">3</span>, min_obs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta_daily</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, beta_daily <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1,543 x 3
##    permno month      beta_daily
##     &lt;dbl&gt; &lt;date&gt;          &lt;dbl&gt;
##  1  10107 1986-05-01      0.898
##  2  10107 1986-06-01      0.906
##  3  10107 1986-07-01      0.822
##  4  10107 1986-08-01      0.900
##  5  10107 1986-09-01      1.01 
##  6  10107 1986-10-01      1.03 
##  7  10107 1986-11-01      1.58 
##  8  10107 1986-12-01      1.64 
##  9  10107 1987-01-01      2.38 
## 10  10107 1987-02-01      1.51 
## # ... with 1,533 more rows</code></pre>
<p>Just for safety and the sake of completeness, we tell our session again to use multiple sessions for parallelization.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/re-exports.html">availableCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The code chunk for beta estimation using daily returns now looks very similar to the one for monthly data. Note that we now used only 3 months of daily data and require at least 50 observations to reduce the likelihood of whack estimates. The whole estimation takes around 30 mins using 8 cores and 32gb memory.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_daily</span> <span class="op">&lt;-</span> <span class="va">crsp_daily_nested</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>beta_daily <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/furrr/man/future_map.html">future_map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu">roll_capm_estimation</span><span class="op">(</span><span class="va">.</span>, months <span class="op">=</span> <span class="fl">3</span>, min_obs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta_daily</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span>, beta_daily <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">beta_daily</span></code></pre></div>
<pre><code>## # A tibble: 3,231,788 x 3
##    permno month      beta_daily
##     &lt;dbl&gt; &lt;date&gt;          &lt;dbl&gt;
##  1  10000 1986-03-01    0.603  
##  2  10000 1986-04-01    0.00754
##  3  10000 1986-05-01   -0.0514 
##  4  10000 1986-06-01    0.0242 
##  5  10000 1986-07-01    0.543  
##  6  10000 1986-08-01    0.557  
##  7  10000 1986-09-01    0.614  
##  8  10000 1986-10-01    0.891  
##  9  10000 1986-11-01    0.970  
## 10  10000 1986-12-01    0.749  
## # ... with 3,231,778 more rows</code></pre>
</div>
<div id="analysis-and-comparison-of-beta-estimates" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Analysis and comparison of beta estimates<a class="anchor" aria-label="anchor" href="#analysis-and-comparison-of-beta-estimates"><i class="fas fa-link"></i></a>
</h2>
<p>What is a typical value for stock betas? To get some feeling, we illustrate the dispersion of the estimated <span class="math inline">\(\hat\beta_i\)</span> across different industries and across time below. The first figure below shows that typical business models across industries imply different exposure to the general market economy. However, there are barely firms that exhibit negative exposure to the market factor.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">beta_monthly</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">beta_monthly</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">industry</span>, <span class="va">permno</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">beta_monthly</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># Mean beta for each company</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">industry</span>, <span class="va">beta</span>, FUN <span class="op">=</span> <span class="va">median</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>,
    title <span class="op">=</span> <span class="st">"Average beta estimates by industry"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="31_beta_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;"></div>
<p>Next we illustrate the time-variation in the cross-section of estimated betas. The figure below shows the monthly deciles of estimated betas (based on monthly data) and indicates an interesting pattern: First, betas seem to vary over time in the sense during some periods there is a clear trend across all deciles. Second, the sample exhibits periods where the dispersion across stocks increases in the sense that the lower decile decreases and upper decile increases which indicates that for some stocks the correlation with the market increases while for others it decreases. Note also here: Stocks with negative betas are an extremely rare exception.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate beta quantile</span>
<span class="va">beta_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">beta_monthly</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">beta_monthly</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,
    quantile <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,
    .groups <span class="op">=</span> <span class="st">"drop"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">x</span>, color <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">quantile</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Beta"</span>, color <span class="op">=</span> <span class="cn">NULL</span>,
    title <span class="op">=</span> <span class="st">"Distribution of estimated betas"</span>,
    subtitle <span class="op">=</span> <span class="st">"Monthly deciles for CRSP cross-section"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="31_beta_files/figure-html/unnamed-chunk-21-1.png" width="768" style="display: block; margin: auto;"></div>
<p>To compare the difference between daily and monthly data, we combine beta estimates to a single table and use the table to plot a comparison of beta estimates for our example stocks.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">beta_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">beta_daily</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">permno</span>, <span class="va">month</span><span class="op">)</span>

<span class="va">beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">examples</span>, by <span class="op">=</span> <span class="st">"permno"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta_monthly</span>, <span class="va">beta_daily</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">company</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, color <span class="op">=</span> <span class="cn">NULL</span>,
    title <span class="op">=</span> <span class="st">"Comparison of beta estimates using 5 years of monthly and 3 months of daily data"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 46 row(s) containing missing values (geom_path).</code></pre>
<div class="inline-figure">
<img src="31_beta_files/figure-html/unnamed-chunk-22-1.png" width="768" style="display: block; margin: auto;">
The estimates look as expected. As you can see, it really depends on the estimation window and data frequency how your beta estimates turn out.</div>
<p>Finally, we write the estimates to our database such that we can use them in later sections.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dbWriteTable</span><span class="op">(</span><span class="va">tidy_finance</span>, <span class="st">"beta"</span>, <span class="va">.</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Whenever you perform some kind of estimation, it also makes sense to do rough plausibility tests. A simple check is to plot the share of stocks with beta estimates over time. This simple descriptive helps us to discover potential errors in our data preparation or estimation procedure. For instance, suppose there was a huge gap in our output where we do not have any betas. In this case, we would have to go back and check all previous steps.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_long</span> <span class="op">&lt;-</span> <span class="va">crsp_monthly</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">beta</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"permno"</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta_monthly</span>, <span class="va">beta_daily</span><span class="op">)</span><span class="op">)</span>

<span class="va">beta_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>share <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">share</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">percent</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, color <span class="op">=</span> <span class="cn">NULL</span>,
    title <span class="op">=</span> <span class="st">"End-of-month share of securities with beta estimates"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="31_beta_files/figure-html/unnamed-chunk-24-1.png" width="768" style="display: block; margin: auto;">
The figure above does not indicate any troubles, so let us move on to the next check.</div>
<p>We also encourage everyone to always look at the distributional summary statistics of your variables. You can easily spot outliers or weird distributions when you look at such tables.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,
    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,
    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,
    q05 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.05</span><span class="op">)</span>,
    q25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.25</span><span class="op">)</span>,
    q50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.50</span><span class="op">)</span>,
    q75 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.75</span><span class="op">)</span>,
    q95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.95</span><span class="op">)</span>,
    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   name          mean    sd   min    q05   q25   q50   q75   q95   max       n
##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;
## 1 beta_daily   0.743 0.925 -43.7 -0.452 0.203 0.679  1.22  2.22  56.6 3186483
## 2 beta_monthly 1.10  0.711 -13.0  0.123 0.631 1.03   1.47  2.31  10.3 2070653</code></pre>
<p>Finally, since we have two different estimators for the same theoretical object, the estimators should be at least positively correlated (although clearly not perfectly as the estimators are based on different sample periods).</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">beta_daily</span>, <span class="va">beta_monthly</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">.</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></code></pre></div>
<pre><code>##              beta_daily beta_monthly
## beta_daily    1.0000000    0.3222342
## beta_monthly  0.3222342    1.0000000</code></pre>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="accessing-managing-financial-data.html"><span class="header-section-number">3</span> Accessing &amp; Managing Financial Data</a></div>
<div class="next"><a href="univariate-sorts.html"><span class="header-section-number">5</span> Univariate Sorts</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#beta-estimation"><span class="header-section-number">4</span> Beta Estimation</a></li>
<li><a class="nav-link" href="#estimate-beta-using-monthly-returns"><span class="header-section-number">4.1</span> Estimate beta using monthly returns</a></li>
<li><a class="nav-link" href="#estimating-beta-using-daily-returns"><span class="header-section-number">4.2</span> Estimating beta using daily returns</a></li>
<li><a class="nav-link" href="#analysis-and-comparison-of-beta-estimates"><span class="header-section-number">4.3</span> Analysis and comparison of beta estimates</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tidy Finance</strong>" was written by Christoph Scheuch, Patrick Weiss and Stefan Voigt. It was last built on 2022-01-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
